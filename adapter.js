"use strict";function maybeFixConfiguration(a){if(a)for(var b=0;b<a.iceServers.length;b++)a.iceServers[b].hasOwnProperty("urls")&&(a.iceServers[b].url=a.iceServers[b].urls,delete a.iceServers[b].urls)}var RTCPeerConnection=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null;if(navigator.mozGetUserMedia)console.log("This appears to be Firefox"),window.webrtcDetectedBrowser="firefox",window.webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10),RTCPeerConnection=function(a,b){return maybeFixConfiguration(a),new mozRTCPeerConnection(a,b)},RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,window.getUserMedia=navigator.mozGetUserMedia.bind(navigator),navigator.getUserMedia=getUserMedia,window.createIceServer=function(a,b,c){var d=null,e=a.split(":");if(0===e[0].indexOf("stun"))d={url:a};else if(0===e[0].indexOf("turn"))if(webrtcDetectedVersion<27){var f=a.split("?");1!==f.length&&0!==f[1].indexOf("transport=udp")||(d={url:f[0],credential:c,username:b})}else d={url:a,credential:c,username:b};return d},window.createIceServers=function(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=createIceServer(a[e],b,c);null!==f&&d.push(f)}return d},window.attachMediaStream=function(a,b){console.log("Attaching media stream"),a.mozSrcObject=b,a.play()},window.reattachMediaStream=function(a,b){console.log("Reattaching media stream"),a.mozSrcObject=b.mozSrcObject,a.play()};else if(navigator.webkitGetUserMedia){console.log("This appears to be Chrome"),window.webrtcDetectedBrowser="chrome";var result=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);null!==result?window.webrtcDetectedVersion=parseInt(result[2],10):window.webrtcDetectedVersion=999,window.createIceServer=function(a,b,c){var d=null,e=a.split(":");return 0===e[0].indexOf("stun")?d={url:a}:0===e[0].indexOf("turn")&&(d={url:a,credential:c,username:b}),d},window.createIceServers=function(a,b,c){var d=[];if(webrtcDetectedVersion>=34)d={urls:a,credential:c,username:b};else for(var e=0;e<a.length;e++){var f=createIceServer(a[e],b,c);null!==f&&d.push(f)}return d},RTCPeerConnection=function(a,b){return webrtcDetectedVersion<34&&maybeFixConfiguration(a),new webkitRTCPeerConnection(a,b)},window.getUserMedia=navigator.webkitGetUserMedia.bind(navigator),navigator.getUserMedia=getUserMedia,window.attachMediaStream=function(a,b){"undefined"!=typeof a.srcObject?a.srcObject=b:"undefined"!=typeof a.mozSrcObject?a.mozSrcObject=b:"undefined"!=typeof a.src?a.src=URL.createObjectURL(b):console.log("Error attaching stream to element.")},window.reattachMediaStream=function(a,b){a.src=b.src}}else console.log("Browser does not appear to be WebRTC-capable");
